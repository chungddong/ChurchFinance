<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>통계</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/statistics.css">
</head>
<body style="background: #f5f6fa; overflow: auto;">
    <div class="statistics-container">
        <!-- 필터 영역 -->
        <div class="filter-section">
            <div class="filter-header">
                <h3>헌금 통계</h3>
            </div>
            
            <div class="filter-controls">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>기간 설정</label>
                        <select id="periodType" onchange="handlePeriodChange()">
                            <option value="custom">사용자 지정</option>
                            <option value="thisMonth" selected>이번 달</option>
                            <option value="lastMonth">지난 달</option>
                            <option value="thisYear">올해</option>
                            <option value="lastYear">작년</option>
                        </select>
                    </div>
                    
                    <div class="filter-group custom-period" id="customPeriod">
                        <label>시작일</label>
                        <input type="date" id="startDate">
                    </div>
                    
                    <div class="filter-group custom-period" id="customPeriodEnd">
                        <label>종료일</label>
                        <input type="date" id="endDate">
                    </div>
                </div>
                
                <div class="filter-row">
                    <div class="filter-group">
                        <label>헌금 유형</label>
                        <select id="filterType">
                            <option value="">전체 유형</option>
                            <option value="십일조">십일조</option>
                            <option value="감사헌금">감사헌금</option>
                            <option value="특별헌금">특별헌금</option>
                            <option value="선교헌금">선교헌금</option>
                            <option value="건축헌금">건축헌금</option>
                            <option value="절기헌금">절기헌금</option>
                            <option value="기타">기타</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>성도 선택</label>
                        <select id="filterMember">
                            <option value="">전체 성도</option>
                        </select>
                    </div>
                    
                    <div class="filter-group button-group">
                        <button class="btn-filter" onclick="applyFilters()">조회</button>
                    </div>
                    
                    <div class="filter-group button-group">
                        <button class="btn-reset" onclick="resetFilters()">초기화</button>
                    </div>
                </div>
            </div>
        </div>


        <!-- 상세 통계 표 -->
        <div class="statistics-table-section">
            <div class="table-header">
                <h4>상세 헌금 내역</h4>
                <div class="table-header-right">
                    <div class="export-buttons">
                        <button class="btn-export excel" onclick="exportToExcel()" title="엑셀 다운로드">
                            📊 엑셀
                        </button>
                        <button class="btn-export pdf" onclick="exportToPDF()" title="PDF 다운로드">
                            📄 PDF
                        </button>
                    </div>
                    <div class="table-info">
                        조회 기간: <span id="periodInfo">전체</span> | 
                        총 <span id="tableCount">0</span>건
                    </div>
                </div>
            </div>
            
            <div class="table-container" id="statisticsTable">
                <div class="no-data">
                    조회할 헌금 내역이 없습니다.
                </div>
            </div>
        </div>

        <!-- 유형별 통계 -->
        <div class="type-statistics-section">
            <h4>헌금 유형별 통계</h4>
            <div class="type-stats-container" id="typeStatsContainer">
                <div class="no-data">
                    조회할 데이터가 없습니다.
                </div>
            </div>
        </div>

        <!-- 월별 통계 (연간 조회 시에만 표시) -->
        <div class="monthly-statistics-section" id="monthlyStatsSection" style="display: none;">
            <h4>월별 헌금 현황</h4>
            <div class="monthly-stats-container" id="monthlyStatsContainer">
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="../js/statistics.js"></script>
</body>
</html>