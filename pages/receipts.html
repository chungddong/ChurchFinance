<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>기부금 영수증</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/receipts.css">
</head>
<body style="background: #f5f6fa; overflow: auto;">
    <div class="receipts-container">
        <!-- 성도 선택 및 필터 영역 -->
        <div class="filter-section">
            <div class="filter-header">
                <h3>기부금 영수증 발급</h3>
            </div>
            
            <div class="filter-controls">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>성도 선택 *</label>
                        <select id="memberSelect" onchange="loadMemberDonations()">
                            <option value="">성도를 선택하세요</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>기간 설정</label>
                        <select id="periodType" onchange="handlePeriodChange()">
                            <option value="thisYear" selected>올해</option>
                            <option value="lastYear">작년</option>
                            <option value="custom">사용자 지정</option>
                        </select>
                    </div>
                    
                    <div class="filter-group custom-period" id="customPeriod">
                        <label>시작일</label>
                        <input type="date" id="startDate">
                    </div>
                    
                    <div class="filter-group custom-period" id="customPeriodEnd">
                        <label>종료일</label>
                        <input type="date" id="endDate">
                    </div>
                </div>
                
                <div class="filter-row">
                    <div class="filter-group">
                        <label>헌금 유형</label>
                        <select id="filterType">
                            <option value="">전체 유형</option>
                            <option value="십일조">십일조</option>
                            <option value="감사헌금">감사헌금</option>
                            <option value="특별헌금">특별헌금</option>
                            <option value="선교헌금">선교헌금</option>
                            <option value="건축헌금">건축헌금</option>
                            <option value="절기헌금">절기헌금</option>
                            <option value="기타">기타</option>
                        </select>
                    </div>
                    
                    <div class="filter-group button-group">
                        <button class="btn-filter" onclick="applyFilters()">조회</button>
                    </div>
                    
                    <div class="filter-group button-group">
                        <button class="btn-reset" onclick="resetFilters()">초기화</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 헌금 내역 테이블 -->
        <div class="donations-table-section">
            <div class="table-header">
                <div class="table-header-left">
                    <h4>헌금 내역</h4>
                    <div class="member-info" id="memberInfo" style="display: none;">
                        <span class="member-name" id="selectedMemberName"></span>님의 헌금 내역
                    </div>
                </div>
                <div class="table-header-right">
                    <div class="selection-controls">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                            <span class="checkmark"></span>
                            전체선택
                        </label>
                        <span class="selected-count" id="selectedCount">0개 선택</span>
                    </div>
                    <div class="export-buttons">
                        <button class="btn-export excel" onclick="exportToExcel()" disabled id="excelBtn">
                            엑셀
                        </button>
                        <button class="btn-export pdf" onclick="exportToPDF()" disabled id="pdfBtn">
                            PDF
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="table-container" id="donationsTable">
                <div class="no-data">
                    성도를 선택하여 헌금 내역을 조회하세요.
                </div>
            </div>
            
            <div class="table-summary" id="tableSummary" style="display: none;">
                <div class="summary-info">
                    <span>선택된 항목 총액: <strong id="selectedTotal">0</strong>원</span>
                    <span>|</span>
                    <span>전체 총액: <strong id="totalAmount">0</strong>원</span>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/receipts.js"></script>
</body>
</html>